CREATE DATABASE SHOP_BAN_GIAY_TEAM2_PRO1041
GO
USE SHOP_BAN_GIAY_TEAM2_PRO1041
GO
-- ChucVu
CREATE TABLE ChucVu(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
TrangThai INT default 0
)
GO
--SanPham
CREATE TABLE SanPham(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50)
)
GO
--NCC
CREATE TABLE NhaCungCap(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50),
TrangThai INT Default 0
)
GO
-- NSX
CREATE TABLE NSX(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50),
TrangThai int default 0
)
GO
-- MauSac
CREATE TABLE MauSac(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50),
TrangThai int default 0
)
GO
-- LoaiSP
CREATE TABLE LoaiSP(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50),
TrangThai int default 0,
idCha UNIQUEIDENTIFIER,
)
GO
--Hang
CREATE TABLE Hang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50),
TrangThai int default 0,
)
GO
--ChiTietSP
CREATE TABLE ChiTietSP(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdGiay UNIQUEIDENTIFIER,
IdLoaiSP UNIQUEIDENTIFIER,
IdNsx UNIQUEIDENTIFIER,
IdMauSac UNIQUEIDENTIFIER,
IdHang UNIQUEIDENTIFIER,
IdNhaCC UNIQUEIDENTIFIER,
ThoiGianBH INT DEFAULT NULL,
MoTa NVARCHAR(50) DEFAULT NULL,
Size int,
SoLuong INT,
GiaNhap DECIMAL(20,0) DEFAULT 0,
GiaBan DECIMAL(20,0) DEFAULT 0,
Barcode NVARCHAR(50) NULL,
TrangThai INT default 0
)
GO
--NhanVien
CREATE TABLE NhanVien(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
HoTen NVARCHAR(100) DEFAULT NULL,
TenTK varchar(50) DEFAULT NULL,
MatKhau varchar(20) DEFAULT NULL,
GioiTinh NVARCHAR(10) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
Sdt VARCHAR(10) DEFAULT NULL,
NgayTao date,
GhiChu nvarchar(100),
IdCV UNIQUEIDENTIFIER,
TrangThai INT DEFAULT 0
)
GO
-- KhachHang
CREATE TABLE KhachHang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
HoTen NVARCHAR(100),
NgaySinh DATE DEFAULT NULL,
Sdt VARCHAR(10) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
TrangThai INT default 0
)
GO
--HoaDon
CREATE TABLE HoaDon(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdKH UNIQUEIDENTIFIER default null,
IdNV UNIQUEIDENTIFIER,
MaHD varchar(20),
NgayTao DATEtime DEFAULT NULL,
NgayThanhToan DATEtime DEFAULT NULL,
NgayShip DATEtime DEFAULT NULL,
NgayNhanHang DATEtime DEFAULT NULL,
NgayDaNhanHang DATEtime DEFAULT NULL,
PhiShip DECIMAL(20,0) default 0,
DiaChiGiaoHang nvarchar(255) default null,
TongTien DECIMAL(20,0) DEFAULT 0,
GhiChu nvarchar(100),
SDTNguoiGiaoHang nvarchar(10),
TrangThai INT DEFAULT 0,
)
GO
CREATE TABLE HinhThucThanhToan(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdHD UNIQUEIDENTIFIER,
LoaiThanhToan nvarchar(50),
TongTien DECIMAL(20,0) DEFAULT 0,
NgayThanhToan dateTime DEFAULT NULL,
TinhTrang INT DEFAULT 0,
)
GO
--HoaDonChiTiet
CREATE TABLE HoaDonChiTiet(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdHoaDon UNIQUEIDENTIFIER,
IdChiTietSP UNIQUEIDENTIFIER,
SoLuong INT,
DonGia DECIMAL(20,0) DEFAULT 0,
TrangThai int default 0,
CONSTRAINT FK1 FOREIGN KEY(IdHoaDon) REFERENCES HoaDon(Id),
CONSTRAINT FK2 FOREIGN KEY(IdChiTietSP) REFERENCES ChiTietSP(Id),
)
GO
--GiaoCa
CREATE TABLE GiaoCa(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma varchar(20) unique,
ThoiGianNhanCa dateTime,
ThoiGianGiaoCa dateTime,
IdNVTrongCa UNIQUEIDENTIFIER,
IdNVCaTiepTheo UNIQUEIDENTIFIER,
TienBanDau DECIMAL(20,0) DEFAULT 0,
TongTienTrongCa DECIMAL(20,0) DEFAULT 0,
TongTienMat DECIMAL(20,0) DEFAULT 0,
TongTienKhac DECIMAL(20,0) DEFAULT 0,
TienPhatSinh DECIMAL(20,0) DEFAULT 0,
GhiChuPhatSinh nvarchar(100),
TongTienMatCaTruoc DECIMAL(20,0) DEFAULT 0,
ThoiGianReset DateTime,
IdChuCuaHangReset UNIQUEIDENTIFIER,
TongTienMatRut DECIMAL(20,0) DEFAULT 0,
TrangThai INT default 0,
)
GO
--PhieuGiamGia
CREATE TABLE PhieuGiamGia(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
LoaiGiamGia  Nvarchar(30),
NgayBD DATETIME,
NgayKT DATETIME,
TrangThai INT default 0,
)
GO
--GiamGiaChiTiet
CREATE TABLE GiamGiaChiTiet(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdGG UNIQUEIDENTIFIER,
IdChiTietSP UNIQUEIDENTIFIER,
GiaTriGG DECIMAL(20,0) DEFAULT 0,
TrangThai INT default 0,
)
/*
--TichDiem
CREATE TABLE TichDiem(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
SoDiem INT default 0,
IdKH UNIQUEIDENTIFIER,
TrangThai int default 0,
)
*/
GO
ALTER TABLE LoaiSP ADD FOREIGN KEY(IdCha) REFERENCES LoaiSP(Id)


ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdGiay) REFERENCES SanPham(Id)

ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdNhaCC) REFERENCES NhaCungCap(Id)

ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdNsx) REFERENCES Nsx(Id)

ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdMauSac) REFERENCES MauSac(Id)

ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdLoaiSP) REFERENCES LoaiSP(Id)

ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdHang) REFERENCES Hang(Id)

ALTER TABLE HoaDon ADD FOREIGN KEY (IdKH) REFERENCES KhachHang(Id)

ALTER TABLE HoaDon ADD FOREIGN KEY (IdNV) REFERENCES NhanVien(Id)

ALTER TABLE HinhThucThanhToan ADD FOREIGN KEY (IdHD) REFERENCES HoaDon(Id)

ALTER TABLE NhanVien ADD FOREIGN KEY (IdCV) REFERENCES ChucVu(Id)

ALTER TABLE GiaoCa ADD FOREIGN KEY (IdNVTrongCa) REFERENCES NhanVien(Id)

--ALTER TABLE TichDiem ADD FOREIGN KEY (IdKH) REFERENCES KhachHang(Id)

ALTER TABLE GiamGiaChiTiet ADD FOREIGN KEY(IdGG) REFERENCES PhieuGiamGia(Id)

ALTER TABLE GiamGiaChiTiet  ADD FOREIGN KEY(IdChiTietSP) REFERENCES ChiTietSP(Id)

--------
GO
insert into NSX(Ma,Ten) 
values('NSX001',N'Pou Chen'),
('NSX002',N'Thượng Đình'),
('NSX003',N'Bitis'),
('NSX004',N'RieNevan'),
('NSX005',N'Midaz'),
('NSX006',N'Ananas'),
('NSX007',N'COX Shoes'),
('NSX008',N'MORE THAN BASIS')
GO
-------
insert into SanPham(Ma,Ten)
values('SP001','Nike Air Force 1'),
('SP002','Oxford'),
('SP003','Slippers'),
('SP004','Yeezy Boost 350 V2 Static Black'),
('SP005','Converse cổ cao'),
('SP006','Vans'),
('SP007','Balenciaga Track'),
('SP008','Under Armour Hovr Phantom'),
('SP009','Biti’s Hunter Midnight Black'),
('SP010','New Balance 624'),
('SP011','Puma'),
('SP012','Li-ning'),
('SP013',' Adidas TENNIS Grand Court'),
('SP014','sneaker Motorsport Mercedes'),
('SP015',' Alexander MC Queen')
--------------
GO
---------------
insert into NhaCungCap(Ma,Ten) 
values('NCC01',N'Công Ty TNHH Giày Á Châu'),
('NCC002',N'Công Ty TNHH Sản Xuất Hàng Tiêu Dùng Bình Tân'),
('NCC003',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC004',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC005',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC006',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC007',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC008',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC009',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC010',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC011',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC012',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC013',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC014',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh'),
('NCC015',N'Công Ty TNHH SX TM DV Giầy Đông Thịnh')
----------------
GO
insert into MauSac(Ma,Ten)
values('MS001',N'Vàng'),
('MS002',N'Xanh'),
('MS003',N'Đỏ'),
('MS004',N'Tím'),
('MS005',N'Trắng'),
('MS006',N'Nâu'),
('MS007',N'Đen')
------------------
GO
insert into LoaiSP(Ma,Ten)
values('L001', N'Tối giản'),
('L002', N'Đi bộ'),
('L003', N'Tennis'),
('L004', N'Tập luyện đa năng'),
('L005', N'Chạy địa hình'),
('L006', N'bóng rổ'),
('L007', N'bóng đá')
------------------
GO
insert into Hang(Ma,Ten)
values('H001',N'Adidas'),
('H002',N'Nike'),
('H003',N'Fila'),
('H004',N'Vans'),
('H005',N'Puma'),
('H006',N'New Balance'),
('H007',N'Domba'),
('H008',N'Lacoste'),
('H009',N'Louis Vuitton'),
('H010',N'Gucci'),
('H011',N'Dolce & Gabbana'),
('H012',N'Reebok'),
('H013',N'Asics'),
('H014',N'Clavin klein'),
('H015',N'Tommy Hilfiger'),
('H016',N'YSL'),
('H017',N'Skechers'),
('H018',N'Dsquared2'),
('H019',N'Timberland'),
('H020',N'sparco'),
('H021',N'Duca Di Morrone')
----------------
GO
insert into ChucVu(Ma,Ten)
values('CV001',N'Quản Lí'),
('CV002',N'Nhân Viên')
GO
select * from NhanVien
insert into NhanVien(Ma,HoTen,TenTK,MatKhau,GioiTinh,DiaChi,Sdt,IdCV,TrangThai) 
values
('NV04',N'Nguyễn Quang Tịnh','tinhph23160','123456',N'Nam',N'Hà nội','0399199283','B9F1FA89-FC11-4D52-92E7-2E8FBD3008AC',0)

update NhanVien set TenTK = 'tiph23160' where Ma = 'NV03'
---Select----
GO



select * from SanPham order by Ma asc
select * from LoaiSP order by Ma asc
select * from NSX order by Ma asc
select * from MauSac order by Ma asc
select * from Hang order by Ma asc
select * from NhaCungCap order by Ma asc

select* from  KhachHang
select * from ChiTietSP
select * from ChucVu
select * from NhanVien
select * from hoadon
 ORDER BY Cast(SUBSTRING(dbo.HoaDon.MaHD, 3,2) as int)
 update HoaDon set ngaythanhtoan = getDate() where id ='610C1C31-6709-475A-8F44-FD9FCDC02FE2'
----------

----Delete-----
select * from NhaCungCap
select * from NSX
select * from Hang
select * from LoaiSP
select * from MauSac
select * from SanPham
select * from ChucVu

---------------

insert into ChiTietSP  (IdGiay,IdLoaiSP,IdNsx,IdMauSac,IdHang,IdNhaCC,ThoiGianBH,MoTa,Size,SoLuong,GiaNhap,GiaBan,TrangThai,Barcode) 
values
('E2F29D90-AEEF-4945-A597-179CF25FD23D','9496174F-4CCA-4185-829D-83CBF2151032','517BA4E4-A391-46A2-ACB8-8C69E64F3593','E40D027E-9130-4F5D-8DBA-39499AB1CB77','8E6363E2-266A-4E03-AC82-3E9E99DBDDCB','A476EA08-60CA-4805-979D-E269ACB0784A',5,N'Không',36,6,40000,70000,0,'4944323282'),
('424AF40F-4DAB-4673-90F4-80BAD800C1A3','9496174F-4CCA-4185-829D-83CBF2151032','517BA4E4-A391-46A2-ACB8-8C69E64F3593','E40D027E-9130-4F5D-8DBA-39499AB1CB77','8E6363E2-266A-4E03-AC82-3E9E99DBDDCB','A476EA08-60CA-4805-979D-E269ACB0784A',5,N'Không',36,1000,40000,70000,0,'4944323282'),
('573B1356-3751-4056-9F4B-E49AE56EDD32','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D41229BD-D974-4FB0-8E6C-347798E4965C','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,40000,70000,0,'1744499737'),
('573B1356-3751-4056-9F4B-E49AE56EDD32','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,40000,70000,0,'4153392635'),
('209629B8-657F-475F-BE4F-BD89A870E842','424D953C-3B55-467E-B20B-131E3045FC03','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,60000,100000,0,'9428534549'),
('928559ED-0AC4-4FF1-A65E-C391A5D22D18','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,30000,50000,0,'4068750610'),
('09973901-4D48-4F2D-A057-2CDFA3FA734A','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,50000,80000,0,'6508902344'),
('665D2347-4C9F-4409-A494-473E6ED8024E','D5E5E109-A0A5-4596-91DD-5F3DC92168EA','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,30000,60000,0,'2425732373'),
('993B0D27-097E-4E7E-AEF0-18E253E2EB46','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,20000,40000,0,'1283374738'),
('DB89A091-E561-42C1-8470-07246C9117B0','424D953C-3B55-467E-B20B-131E3045FC03','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,70000,110000,0,'1026775211'),
('16AC27E4-67D8-4534-9A2A-28522D18B848','A2B8E415-EBC3-4A68-B469-695F5457547B','31B2E6EF-A228-481A-B51D-FD3853348AC6','D1C2A9AA-3CA5-4D60-8291-32290627F92F','FD72C6DE-8A93-4815-BAE6-C3A51BD500EE','FA83FB8D-2F25-4122-99D3-3EAD20E9D41C',5,N'Không',36,1000,90000,120000,0,'8438655938')

select TOP 6  nv.Ma, nv.HoTen, nv.TenTK, nv.MatKhau, nv.GioiTinh, nv.DiaChi, nv.Sdt , cv.Ten, nv.TrangThai from NhanVien nv join ChucVu cv on nv.IdCV = cv.Id 
 where nv.Ma not in (select top 1 Ma from NhanVien order by Ma asc) order by nv.Ma asc


 select TOP 5 ctsp.Id, sp.Ma as MaSP, sp.Ten as TenSP ,loai.Ten as tenLoai ,ms.Ten as tenMauSac,ctsp.Size,ctsp.SoLuong,ctsp.GiaBan from ChiTietSP ctsp join SanPham sp on ctsp.IdGiay = sp.Id 
  join LoaiSP loai on ctsp.IdLoaiSP = loai.Id join MauSac ms on ctsp.IdMauSac = ms.Id where sp.Ma not in (select top 0  Ma from SanPham order by Ma asc) order by sp.Ma asc;
      SELECT day(NgayTao) as Ngay, TongTien, TrangThai 
FROM HoaDon where day(NgayTao) like 10 
